#! /bin/bash

set -eo pipefail

SCRIPT_DIR=$(
    cd $(dirname $0)
    pwd
)
CAMPE_PATH=$SCRIPT_DIR/../content
WORK_DIR=~/ScreenShots

cd $WORK_DIR

find *.mov | while read fn
do
    base=${fn%.*}
    ffmpeg -i "$fn" -filter_complex "[0:v] fps=10,scale=640:-1,split [a][b];[a] palettegen [p];[b][p] paletteuse" "$base.gif"
done
